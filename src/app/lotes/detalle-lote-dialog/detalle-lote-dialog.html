<div class="dialog-container">
  <div class="dialog-header">
    <div class="header-content">
      <h2 class="dialog-title">Detalle de Lote</h2>
      <p class="dialog-subtitle">Información completa del lote seleccionado</p>
    </div>
    <button mat-icon-button mat-dialog-close class="close-button">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <div class="dialog-content">
    <div class="form-container">
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">ID Lote</label>
          <input
            class="form-input"
            [value]="formatearCodigo(lote.id_lote)"
            readonly
          />
        </div>

        <div class="form-group">
          <label class="form-label">Código de Lote</label>
          <input
            class="form-input"
            [value]="formatearTexto(lote.lote)"
            readonly
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Insumo</label>
          <input
            class="form-input"
            [value]="formatearTexto(insumo?.nombre)"
            readonly
          />
        </div>

        <div class="form-group">
          <label class="form-label">Estado</label>
          <input
            class="form-input"
            [value]="formatearTexto(lote.estado_lote)"
            readonly
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Ubicación</label>
          <input
            class="form-input"
            [value]="formatearTexto(lote.ubicacion)"
            readonly
          />
        </div>

        <div class="form-group">
          <label class="form-label">Fecha de Expiración</label>
          <input
            class="form-input"
            [value]="formatearFecha(lote.fecha_expiracion)"
            readonly
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Stock Inicial</label>
          <input
            class="form-input"
            [value]="formatearNumero(lote.stock_inicial)"
            readonly
          />
        </div>

        <div class="form-group">
          <label class="form-label">Stock Actual</label>
          <input
            class="form-input"
            [value]="formatearNumero(lote.stock_actual)"
            readonly
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Stock Utilizado</label>
          <input
            class="form-input"
            [value]="formatearNumero((lote.stock_inicial || 0) - (lote.stock_actual || 0))"
            readonly
          />
        </div>

        <div class="form-group">
          <label class="form-label">Precio Total</label>
          <input
            class="form-input"
            [value]="formatearPrecio(lote.precio_total)"
            readonly
          />
        </div>
      </div>

      <!-- Indicador visual de stock -->
      <div class="form-row" *ngIf="lote.stock_inicial && lote.stock_actual">
        <div class="form-group form-group-full">
          <label class="form-label"
            >Estado del Stock ({{ calcularPorcentajeStock() }}%)</label
          >
          <div class="stock-indicator">
            <div class="stock-bar">
              <div
                class="stock-fill"
                [style.width.%]="calcularPorcentajeStock()"
                [class]="{
                  'stock-critical': calcularPorcentajeStock() <= 10,
                  'stock-low': calcularPorcentajeStock() <= 25 && calcularPorcentajeStock() > 10,
                  'stock-medium': calcularPorcentajeStock() <= 50 && calcularPorcentajeStock() > 25,
                  'stock-good': calcularPorcentajeStock() > 50
                }"
              ></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Información adicional de vencimiento -->
      <div class="form-row" *ngIf="lote.fecha_expiracion">
        <div class="form-group">
          <label class="form-label">Estado de Vencimiento</label>
          <input class="form-input" [value]="getEstadoVencimiento()" readonly />
        </div>

        <div class="form-group">
          <label class="form-label">Días para Vencimiento</label>
          <input
            class="form-input"
            [value]="getDiasParaVencimiento() + ' días'"
            readonly
          />
        </div>
      </div>
    </div>
  </div>
</div>
