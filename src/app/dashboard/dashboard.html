<div class="page-container">
  <div class="page-content">
    <!-- Header -->
    <div class="page-header">
      <div class="header-content">
        <h1 class="page-title text-texfina text-primary">Dashboard</h1>
      </div>
      <div class="header-actions">
        <button class="btn-texfina btn-primary" (click)="actualizarDashboard()">
          <i class="pi pi-refresh" [class.pi-spin]="isLoading"></i>
          Actualizar Datos
        </button>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-container">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Cargando métricas del dashboard...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="hasError && !isLoading" class="error-container">
      <i class="pi pi-exclamation-triangle"></i>
      <h3>Error al cargar dashboard</h3>
      <p>{{ errorMessage }}</p>
      <p-button
        label="Reintentar"
        icon="pi pi-refresh"
        (onClick)="reintentarCarga()"
        size="small"
      ></p-button>
    </div>

    <!-- Dashboard Content -->
    <div *ngIf="!isLoading && !hasError" class="dashboard-content">
      <!-- Quick Access Section -->
      <div class="quick-access-section">
        <div class="quick-access-grid">
          <div class="quick-access-card" routerLink="ingresos">
            <div class="quick-access-icon">
              <i class="pi pi-plus-circle"></i>
            </div>
            <div class="quick-access-content">
              <h4>Ingresos</h4>
              <p>Registrar nuevos insumos</p>
            </div>
          </div>

          <div class="quick-access-card" routerLink="movimientos">
            <div class="quick-access-icon">
              <i class="pi pi-arrows-alt"></i>
            </div>
            <div class="quick-access-content">
              <h4>Movimientos</h4>
              <p>Transferencias entre almacenes</p>
            </div>
          </div>

          <div class="quick-access-card" routerLink="pesado">
            <div class="quick-access-icon">
              <i class="pi pi-compass"></i>
            </div>
            <div class="quick-access-content">
              <h4>Pesado</h4>
              <p>Operaciones de pesaje</p>
            </div>
          </div>

          <div class="quick-access-card" routerLink="consumos">
            <div class="quick-access-icon">
              <i class="pi pi-qrcode"></i>
            </div>
            <div class="quick-access-content">
              <h4>Escaneado</h4>
              <p>Consumos con código QR</p>
            </div>
          </div>

          <div class="quick-access-card" routerLink="stock">
            <div class="quick-access-icon">
              <i class="pi pi-chart-bar"></i>
            </div>
            <div class="quick-access-content">
              <h4>Stock</h4>
              <p>Consultar inventario actual</p>
            </div>
          </div>

          <div class="quick-access-card" routerLink="reportes">
            <div class="quick-access-icon">
              <i class="pi pi-file-pdf"></i>
            </div>
            <div class="quick-access-content">
              <h4>Reportes</h4>
              <p>Generar informes y análisis</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Charts Section - NUEVOS DASHBOARDS -->
      <div class="charts-section">
        <!-- Primera fila de gráficos - DASHBOARDS PRINCIPALES -->
        <div class="charts-row">
          <!-- Dashboard de Inventario -->
          <div class="chart-card large">
            <p-card>
              <ng-template pTemplate="header">
                <div class="chart-header">
                  <h3>
                    <i class="pi pi-box"></i>
                    Dashboard de Inventario
                  </h3>
                  <span class="chart-subtitle">Rotación por categoría</span>
                </div>
              </ng-template>
              <div class="chart-container mixed-chart">
                <p-chart
                  type="bar"
                  [data]="inventarioRotacionData"
                  [options]="inventarioRotacionOptions"
                  ariaLabel="Rotación de inventario por categoría"
                ></p-chart>
              </div>
            </p-card>
          </div>

          <!-- Dashboard de Costos -->
          <div class="chart-card">
            <p-card>
              <ng-template pTemplate="header">
                <div class="chart-header">
                  <h3>
                    <i class="pi pi-dollar"></i>
                    Dashboard de Costos
                  </h3>
                  <span class="chart-subtitle">Distribución por almacén</span>
                </div>
              </ng-template>
              <div class="chart-container pie-chart">
                <p-chart
                  type="doughnut"
                  [data]="costosAlmacenData"
                  [options]="costosAlmacenOptions"
                  ariaLabel="Costos por almacén"
                ></p-chart>
              </div>
            </p-card>
          </div>
        </div>

        <!-- Segunda fila de gráficos - DASHBOARDS ADICIONALES -->
        <div class="charts-row">
          <!-- Dashboard de Trazabilidad -->
          <div class="chart-card">
            <p-card>
              <ng-template pTemplate="header">
                <div class="chart-header">
                  <h3>
                    <i class="pi pi-search"></i>
                    Dashboard de Trazabilidad
                  </h3>
                  <span class="chart-subtitle">Estados de lotes</span>
                </div>
              </ng-template>
              <div class="chart-container polar-chart">
                <p-chart
                  type="polarArea"
                  [data]="trazabilidadLotesData"
                  [options]="trazabilidadLotesOptions"
                  ariaLabel="Estados de lotes por trazabilidad"
                ></p-chart>
              </div>
            </p-card>
          </div>

          <!-- Dashboard de Desempeño -->
          <div class="chart-card">
            <p-card>
              <ng-template pTemplate="header">
                <div class="chart-header">
                  <h3>
                    <i class="pi pi-chart-line"></i>
                    Dashboard de Desempeño
                  </h3>
                  <span class="chart-subtitle">Eficiencia por operación</span>
                </div>
              </ng-template>
              <div class="chart-container bar-chart">
                <p-chart
                  type="bar"
                  [data]="desempenoEficienciaData"
                  [options]="desempenoEficienciaOptions"
                  ariaLabel="Eficiencia de operaciones"
                ></p-chart>
              </div>
            </p-card>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
