// Custom Theming for Angular Material
// For more information: https://material.angular.dev/guide/theming
@use "@angular/material" as mat;
@use "sass:map";

// Definición de breakpoints mejorados
$breakpoints: (
  xs: 0,
  sm: 480px,
  md: 768px,
  lg: 960px,
  xl: 1200px,
  xxl: 1440px,
);

// Mixins para media queries
@mixin respond-to($breakpoint) {
  @if map.has-key($breakpoints, $breakpoint) {
    @media (min-width: map.get($breakpoints, $breakpoint)) {
      @content;
    }
  }
}

@mixin respond-to-max($breakpoint) {
  @if map.has-key($breakpoints, $breakpoint) {
    $breakpoint-value: map.get($breakpoints, $breakpoint);
    @media (max-width: #{$breakpoint-value - 1px}) {
      @content;
    }
  }
}

// Configuración del tema de Material
html {
  @include mat.theme(
    (
      color: (
        theme-type: light,
        primary: mat.$azure-palette,
        tertiary: mat.$blue-palette,
      ),
      typography: Roboto,
      density: 0,
    )
  );
}

// Estilos base responsive
html,
body {
  height: 100%;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  overflow-x: hidden;
}

*,
*::before,
*::after {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: Roboto, "Helvetica Neue", sans-serif;
  line-height: 1.5;
}

// Eliminar scrollbars del mat-sidenav-container y sidebar
mat-sidenav-container {
  overflow: hidden !important;
}

mat-sidenav {
  overflow: hidden !important;
}

mat-sidenav-content {
  overflow: hidden !important;
}

// Reglas específicas para el sidebar
.sidebar {
  overflow: hidden !important;

  * {
    overflow: hidden !important;
  }
}

.sidebar-menu {
  overflow: hidden !important;

  li,
  a {
    overflow: visible !important;
  }
}

// Personalización de scrollbars para webkit
::-webkit-scrollbar {
  width: 6px;
}

::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 10px;
}

::-webkit-scrollbar-thumb {
  background: #c1c1c1;
  border-radius: 10px;

  &:hover {
    background: #a1a1a1;
  }
}

// Para Firefox
html {
  scrollbar-width: thin;
  scrollbar-color: #c1c1c1 #f1f1f1;
}

// Clases de utilidad responsive mejoradas
.responsive-container {
  width: 100%;
  padding-right: 1rem;
  padding-left: 1rem;
  margin-right: auto;
  margin-left: auto;

  @include respond-to("sm") {
    max-width: 540px;
    padding-right: 1.5rem;
    padding-left: 1.5rem;
  }
  @include respond-to("md") {
    max-width: 720px;
  }
  @include respond-to("lg") {
    max-width: 960px;
  }
  @include respond-to("xl") {
    max-width: 1140px;
  }
  @include respond-to("xxl") {
    max-width: 1320px;
  }
}

// Utilidades Flexbox mejoradas
.d-flex {
  display: flex !important;
}

.flex-column {
  flex-direction: column !important;
}

.flex-row {
  flex-direction: row !important;
}

.justify-content-between {
  justify-content: space-between !important;
}

.justify-content-center {
  justify-content: center !important;
}

.align-items-center {
  align-items: center !important;
}

.flex-wrap {
  flex-wrap: wrap !important;
}

.flex-grow-1 {
  flex-grow: 1 !important;
}

.flex-shrink-0 {
  flex-shrink: 0 !important;
}

// Utilidades de espaciado responsive
.p-0 {
  padding: 0 !important;
}
.p-1 {
  padding: 0.25rem !important;
}
.p-2 {
  padding: 0.5rem !important;
}
.p-3 {
  padding: 1rem !important;
}
.p-4 {
  padding: 1.5rem !important;
}
.p-5 {
  padding: 3rem !important;
}

.m-0 {
  margin: 0 !important;
}
.m-1 {
  margin: 0.25rem !important;
}
.m-2 {
  margin: 0.5rem !important;
}
.m-3 {
  margin: 1rem !important;
}
.m-4 {
  margin: 1.5rem !important;
}
.m-5 {
  margin: 3rem !important;
}

// Utilidades de texto responsive
.text-center {
  text-align: center !important;
}

.text-left {
  text-align: left !important;
}

.text-right {
  text-align: right !important;
}

.text-truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

// Grid responsive mejorado
.grid-container {
  display: grid;
  gap: 1rem;
  padding: 1rem;

  @include respond-to("sm") {
    grid-template-columns: repeat(2, 1fr);
    gap: 1.5rem;
    padding: 1.5rem;
  }

  @include respond-to("md") {
    grid-template-columns: repeat(3, 1fr);
  }

  @include respond-to("lg") {
    grid-template-columns: repeat(4, 1fr);
  }

  @include respond-to("xl") {
    gap: 2rem;
    padding: 2rem;
  }
}

// Utilidades de visibilidad responsive
.d-none {
  display: none !important;
}

@include respond-to-max("sm") {
  .d-sm-none {
    display: none !important;
  }
}

@include respond-to-max("md") {
  .d-md-none {
    display: none !important;
  }
}

@include respond-to-max("lg") {
  .d-lg-none {
    display: none !important;
  }
}

// Estilos para elementos de formulario responsive
.form-responsive {
  .mat-mdc-form-field {
    width: 100%;
  }
}

// Asegurar que las tablas sean responsive
.table-responsive {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

// Estilos para botones responsive
.btn-responsive {
  @include respond-to-max("sm") {
    width: 100%;
    margin-bottom: 0.5rem;
  }
}

// ---------------------------------------------------------------------------
// Layout genérico de páginas (consistencia en todas las vistas)
// ---------------------------------------------------------------------------
.page-container {
  display: flex;
  flex-direction: column;
  flex: 1;
  height: 100%;
  padding: 1.5rem;
  background-color: #f5f7fa;
  overflow: hidden;
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  flex-shrink: 0;

  .page-title {
    font-size: 1.75rem;
    font-weight: 500;
    color: #2c3e50;
    margin: 0;
  }
}

.page-content {
  flex: 1;
  min-height: 0; // Importante para que el hijo flex pueda scrollear
  display: flex;
  flex-direction: column;
  overflow: hidden; // Importante para contener el scroll
}

.table-card {
  flex: 1;
  min-height: 0;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
  border-radius: 8px !important;

  .table-container {
    flex: 1;
    overflow: auto;
    min-height: 0; // Importante para que flex funcione correctamente
  }
}

// Aseguramos que cualquier card con la clase legacy `.tabla-card` adopte el nuevo comportamiento
.tabla-card {
  @extend .table-card;
}
